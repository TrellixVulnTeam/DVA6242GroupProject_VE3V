<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
	<meta charset="utf-8">
	 <script src="apartments.js"></script>
	 <link rel="stylesheet" type="text/css" href="styles.css">
	<title>Team 127</title>
</head>
<body>
	<div id="logo_container">
	    <a href="index.html">
		<img id="logo" src="img/logo1.png" align="middle">
	    </a>
	</div>


	<div id="filter">
	    <p>traffic&nbsp;</p>
	    <div class="select" tabindex="1">
		<input class="selectopt" name="traffic" type="radio" id="traffic1">
		<label for="traffic1" class="option">1</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic2">
		<label for="traffic2" class="option">2</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic3">
		<label for="traffic3" class="option">3</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic4">
		<label for="traffic4" class="option">4</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic5" checked>
		<label for="traffic5" class="option">5</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic6">
		<label for="traffic6" class="option">6</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic7">
		<label for="traffic7" class="option">7</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic8">
		<label for="traffic8" class="option">8</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic9">
		<label for="traffic9" class="option">9</label>
		<input class="selectopt" name="traffic" type="radio" id="traffic10">
		<label for="traffic10" class="option">10</label>
	    </div>
	    <p>education&nbsp;</p>
	    <div class="select" tabindex="1">
		<input class="selectopt" name="education" type="radio" id="education1">
		<label for="education1" class="option">1</label>
		<input class="selectopt" name="education" type="radio" id="education2">
		<label for="education2" class="option">2</label>
		<input class="selectopt" name="education" type="radio" id="education3">
		<label for="education3" class="option">3</label>
		<input class="selectopt" name="education" type="radio" id="education4">
		<label for="education4" class="option">4</label>
		<input class="selectopt" name="education" type="radio" id="education5" checked>
		<label for="education5" class="option">5</label>
		<input class="selectopt" name="education" type="radio" id="education6">
		<label for="education6" class="option">6</label>
		<input class="selectopt" name="education" type="radio" id="education7">
		<label for="education7" class="option">7</label>
		<input class="selectopt" name="education" type="radio" id="education8">
		<label for="education8" class="option">8</label>
		<input class="selectopt" name="education" type="radio" id="education9">
		<label for="education9" class="option">9</label>
		<input class="selectopt" name="education" type="radio" id="education10" >
		<label for="education10" class="option">10</label>
	    </div>
	    <p>environment&nbsp;</p>
	    <div class="select" tabindex="1">
		<input class="selectopt" name="environment" type="radio" id="environment1">
		<label for="environment1" class="option">1</label>
		<input class="selectopt" name="environment" type="radio" id="environment2">
		<label for="environment2" class="option">2</label>
		<input class="selectopt" name="environment" type="radio" id="environment3">
		<label for="environment3" class="option">3</label>
		<input class="selectopt" name="environment" type="radio" id="environment4">
		<label for="environment4" class="option">4</label>
		<input class="selectopt" name="environment" type="radio" id="environment5" checked>
		<label for="environment5" class="option">5</label>
		<input class="selectopt" name="environment" type="radio" id="environment6">
		<label for="environment6" class="option">6</label>
		<input class="selectopt" name="environment" type="radio" id="environment7">
		<label for="environment7" class="option">7</label>
		<input class="selectopt" name="environment" type="radio" id="environment8">
		<label for="environment8" class="option">8</label>
		<input class="selectopt" name="environment" type="radio" id="environment9">
		<label for="environment9" class="option">9</label>
		<input class="selectopt" name="environment" type="radio" id="environment10">
		<label for="environment10" class="option">10</label>
	    </div>
	    <p>safety&nbsp;</p>
	    <div class="select" tabindex="1">
		<input class="selectopt" name="safety" type="radio" id="safety1">
		<label for="safety1" class="option">1</label>
		<input class="selectopt" name="safety" type="radio" id="safety2">
		<label for="safety2" class="option">2</label>
		<input class="selectopt" name="safety" type="radio" id="safety3">
		<label for="safety3" class="option">3</label>
		<input class="selectopt" name="safety" type="radio" id="safety4">
		<label for="safety4" class="option">4</label>
		<input class="selectopt" name="safety" type="radio" id="safety5" checked>
		<label for="safety5" class="option">5</label>
		<input class="selectopt" name="safety" type="radio" id="safety6">
		<label for="safety6" class="option">6</label>
		<input class="selectopt" name="safety" type="radio" id="safety7">
		<label for="safety7" class="option">7</label>
		<input class="selectopt" name="safety" type="radio" id="safety8">
		<label for="safety8" class="option">8</label>
		<input class="selectopt" name="safety" type="radio" id="safety9">
		<label for="safety9" class="option">9</label>
		<input class="selectopt" name="safety" type="radio" id="safety10">
		<label for="safety10" class="option">10</label>
	    </div>
	    	<button class="update_image"><img src="img/update.png"></button>
<!-- 	    <button class="button" style="vertical-align:middle"><span>Update </span></button>
 -->	</div>

	<div id="result_list">
<!-- 	    <div class="result">
		<script src="zillowapi.js"></script>
		<script>
		 const Http = new XMLHttpRequest();
		 const url='http://www.zillow.com/webservice/GetSearchResults.htm?zws-id=X1-ZWz17zzknk57gr_4hjdy&address=2114+Bigelow+Ave&citystatezip=Seattle%2C+WA';
		 Http.open("GET", url);
		 Http.setRequestHeader('Access-Control-Allow-Headers', '*');
		 Http.setRequestHeader('Access-Control-Allow-Origin', '*');
		 Http.send();
		 Http.onreadystatechange=(e)=>{
		     console.log(Http.responseText)
		 }
		</script> -->
		
	<div class="ScrollStyle">

<!-- 	    <div class="result">
		<h2></h2>
		<p></p>
		<img src="img/apt1.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt2.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt1.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt2.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt1.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt1.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt2.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt1.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt2.jpg" alt="Lights" style="height:100px">
		<p></p>
		<img src="img/apt1.jpg" alt="Lights" style="height:100px">
		
	    </div> -->
<!-- 
		<div class="panel">
		    <img src='img/apt1.jpg' />
        	<p>A image of an Architecture</p>

		</div>

		<div class="panel">
		    <img src='img/apt1.jpg' />
        	<p>A image of an Architecture</p>

		</div>

		<div class="panel">
		    <img src='img/apt1.jpg' />
        	<p>A image of an Architecture</p>
		</div>
 -->

 		<div class='title1'>
			<script>
				var num_apts = addresses.length;
				var name = 'name';
 				console.log(num_apts);

	            document.write(num_apts + ' apartments in total');
 			</script>

 		</div>
		<div class="panel" onmouseover="markers[0].setIcon(highlightedIcon());" onmouseout="markers[0].setIcon(normalIcon());" >
		    <img src='https://images1.apartments.com/i2/c4fO2mz-tpJlsnZxFln1xnTa9lRswJE7VTwhsPGGf4c/111/270-w-25th-st-unit-4a-new-york-ny-primary-photo.jpg'/>
        	<span>
        	<script>
        		var rent = 2000;
        		var string =
	                '<div class="panel_text1">'+' Rent: '+rent+'</div>' +
	                '<div class="panel_text2">' +
	                  // '<div class="iw-subTitle">' + ratings[i] +'</div>' +
	                    // '<p>LLLL</p>' +
	                  // '<div class="iw-subTitle">Details</div>' +
	                    '<p> Score: ' + 0.1 + ' - Safty: ' + 0.2 + ' - Traffic: ' + 1  + ' - Education: ' + 1 +  ' - Environment: ' + 1 + '</p>'+
	                    // '<br>Yelp link: ' + urls[i] + '</p>'+
	                 '</div>'  ;
	                  // '<div class="iw-bottom-gradient"></div>' +
	           
        		document.write(string);
        	</script>
        	</span>
		</div>

		<div class="panel" onmouseover="markers[1].setIcon(highlightedIcon());" onmouseout="markers[1].setIcon(normalIcon());" >
		    <img src='https://images1.apartments.com/i2/c4fO2mz-tpJlsnZxFln1xnTa9lRswJE7VTwhsPGGf4c/111/270-w-25th-st-unit-4a-new-york-ny-primary-photo.jpg'/>
        	<span>
        	<script>
        		var rent = 2000;
        		var string =
	                '<div class="panel_text1">'+' Rent: '+rent+'</div>' +
	                '<div class="panel_text2">' +
	                  // '<div class="iw-subTitle">' + ratings[i] +'</div>' +
	                    // '<p>LLLL</p>' +
	                  // '<div class="iw-subTitle">Details</div>' +
	                    '<p> Score: ' + 0.1 + ' - Safty: ' + 0.2 + ' - Traffic: ' + 1  + ' - Education: ' + 1 +  ' - Environment: ' + 1 + '</p>'+
	                    // '<br>Yelp link: ' + urls[i] + '</p>'+
	                 '</div>'  ;
	                  // '<div class="iw-bottom-gradient"></div>' +
	           
        		document.write(string);
        	</script>
        	</span>
		</div>

<!-- 		<div class="panel" class="foo">
		    <img src='img/apt1.jpg' />
        	<span>A image of an Architecture</span>
		</div>
		<div class="panel" class="foo">
		    <img src='img/apt1.jpg' />
        	<span>A image of an Architecture</span>
		</div>

		<div class="panel" class="foo">
		    <img src='img/apt1.jpg' />
        	<span>A image of an Architecture</span>
		</div>
 -->
	</div> <!-- end of row -->

	    
	</div>
	
	<div id="map">
	  <script>
	    var markers = [];
	    var infowindows = [];
	    var map;
	    var strings = [];

	    for(i=0; i<addresses.length;i++){
	      var string ='<div id="iw-container">' +
	                    '<div class="iw-subTitle">Apartment Details</div>' +
	                    '<div class="iw-content">' +
	                      // '<div class="iw-subTitle">' + ratings[i] +'</div>' +
	                       // '<a href='+ myurls[i]+'><img src=' + urls[i] + '></a> + ' + '<br>'+
	                      '<img src=' + urls[i] + ' height="120">' + '<br>'+
	                        // '<p>LLLL</p>' +
	                      // '<div class="iw-subTitle">Details</div>' +
	                      '<p> Score: ' + scores[i] + 
	                      '<br>Ranking: ' + '/' + addresses.length +
	                      '<br>Rent: $' + rents[i] +
	                        // '<br>Yelp link: ' + urls[i] + '</p>'+
	                      // '<br><a target="_blank" href=' + myurls[i] + '>Click here to see more details</a>' + '</p>'+
	                    '</div>' +
	                    '<div class="iw-bottom-gradient"></div>' +
	                  '</div>';

	      strings.push(string);
	    }
	 
	    function initMap() {
	      map = new google.maps.Map(document.getElementById('map'), {
	        center: {lat: 40.723040, lng: -73.899180},
	        zoom: 10
	      });


	      var styles = {
	          default: null,
	          hide: [
	            {
	              featureType: 'poi',
	              stylers: [{visibility: 'off'}]
	            },
	            {
	              featureType: 'transit',
	              elementType: 'labels.icon',
	              stylers: [{visibility: 'off'}]
	            }
	          ]
	      };

	      map.setOptions({styles: styles['hide']});

	      var geocoder = new google.maps.Geocoder();
	      var locations = getPoints(geocoder,map);

	      Promise.all(locations)     
	      .then(function(returnVals){
	            console.log(returnVals);
	            console.log(returnVals[0]);
	            for (i = 0; i < returnVals.length; i++) { 
	              addMarker(returnVals[i], map, strings[i])         
	            }


	      })
	    }


	    function normalIcon() {
	      return 'img/marker_house_green.png'
	    }

	    function highlightedIcon() {
	      return 'img/marker_house_pink.png'
	    }

	    function addMarker(location, map, string) {
	      if(infowindow)
	      infowindow.close();
	      var infowindow = new google.maps.InfoWindow({content: string});

	      var marker = new google.maps.Marker({
	        position: location,
	        map: map,
	        icon: normalIcon()         
	      });
	   
	      google.maps.event.addListener(map, "click", function(event) {
	          infowindow.close();
	          marker.setIcon(normalIcon());
	      });

	      marker.addListener('click', function () {
	          for (var j = 0; j < markers.length; j++) {
	            markers[j].setIcon(normalIcon());
	            infowindows[j].close(map, markers[j], strings[i])
	          }
	          marker.setIcon(highlightedIcon());
	          infowindow.open(map, marker, strings[i]);
	      })

	      infowindows.push(infowindow)
	      markers.push(marker);
	    }

	    function getPoints(geocoder,map) {
	      let locationData = [];
	      let latValue;
	      for(let i = 0; i < addresses.length; i++){
	          locationData.push(findLatLang(addresses[i], geocoder, map));
	          console.log(locationData);
	      }
	      return locationData // array of promises
	    }

	    function findLatLang(address, geocoder, mainMap) {
	      return new Promise(function(resolve, reject) {
	        geocoder.geocode({'address': address}, function(results, status) {
	            if (status === 'OK') {
	                console.log(results);
	                // resolve([results[0].geometry.location.lat(), results[0].geometry.location.lng()]);
	                resolve({'lat':results[0].geometry.location.lat(), 'lng':results[0].geometry.location.lng()});
	            } else {
	                reject(new Error('Couldnt\'t find the location ' + address));
	            }
	        })
	      })
	    } 
	  </script>
</div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwrdvLk2XruYEsLwqpYwiqnaKbSwhHiiM&callback=initMap"
    async defer></script>
	
</body>
</html>
